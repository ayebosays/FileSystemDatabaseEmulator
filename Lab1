//
//  main.cpp
//  password
//
//  Created by Brandon Saunders on 4/7/15.
//  Copyright (c) 2015 Brandon Saunders. All rights reserved.
//
//  Program that maintain a username-password system by storing the usernames and passwords in a file. The file will consist of a single username and password per line with a space in between.
//  The constructor accepts a filename, and reads the file one-line at a time and adds values to the vectors user and password. The function addpw adds a user/password pair to end of each vector.

#include <iostream>
#include <string>
#include <fstream>
#include <vector>



using namespace std;

class PasswordFile
{
public:
    PasswordFile(string filename);// opens the file and reads the names/passwords in the vectors user and password.
        
    void addpw(string newuser, string newpassword); //this adds a new user/password to the vectors and writes the vectors to the file filename
    
    bool checkpw(string usr, string passwd); // returns true if user exists and password matches

private:
    string filename; // the file that contains password information
    
    vector<string>user; // the list of usernames
    
    vector<string>password; // the list of passwords
    
    void sync(); //writes the user/password vectors to the password file
};

PasswordFile::PasswordFile(string filename) // opens the file and reads the names/passwords in the vectors user and password.
{
    ifstream infile;
    infile.open("password.txt");
    string s1, s2;
    infile >> s1 >> s2;
    while (infile.good())
    {
        user.push_back(s1.c_str());
        password.push_back(s2.c_str());
        infile >> s1 >> s2;
    }
    
    infile.close();
}

void PasswordFile::addpw(string newuser, string newpassword) { //this adds a new user/password to the vectors and writes the vectors to the file filename
    user.push_back(newuser);
    password.push_back(newpassword);
    sync();
}

bool PasswordFile::checkpw(string usr, string passwd) // returns true if user exists and password matches
{
    for (int i=0; i<user.size(); i++)
    {
        if (user[i] == usr && password[i] == passwd)
        {
            return true;
        }
    }
    return false;
}



void PasswordFile::sync() //writes the user/password vectors to the password file
{
    ofstream outfile;
    outfile.open("password.txt");
    
    for (int i=0; i<user.size(); i++)
    {
        outfile << user[i] << " " << password[i] << endl;
    }
    
    outfile.close();
}



int main()
{
    PasswordFile passfile("password.txt");
    passfile.addpw("dbotting","123qwe");
    passfile.addpw("egomez","qwerty");
    passfile.addpw("tongyu","liberty");
    // write some lines to see if passwords match users
   if (passfile.checkpw("karant","conspiracy"))
   {
       cout << " Aliens do exist";
   }
   else cout << "They don't exist";
}

















